{% extends "base.html" %}
{% load static %}
{% load archivo_nombre %}
{% block titulo %}HISTORIAL DE TICKETS{% endblock titulo %}
{% block contenido %}
	<section class="ftco-section">
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-md-6 text-center mb-5">
					<h2 class="heading-section mb-2">MANUALES</h2>
					<form class="form-inline text-center justify-content-center" action="{% url 'heim:gestionar_documentos' %}" method="get">
                        <div class="form-group mr-2">
                            <label for="id_categoria" class="mr-2">Categoría</label>
                            <select name="cat" class="form-control form-control-md" id="id_categoria">
                                <option value="All">All</option>
                                {% for categoria in categorias %}
                                    <option value="{{ categoria.problema }}">{{ categoria.problema }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <div class="form-group mr-2">
                            <label for="id_subcategoria" class="mr-2">Subcategoría</label>
                            <select name="subcat" class="form-control form-control-md" id="id_subcategoria">
                                <option value="All">All</option>
                                {% for subcategoria in subcategorias %}
                                    <option value="{{ subcategoria.subcategoria }}">{{ subcategoria.subcategoria }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <button class="btn btn-primary mt-2" type="submit">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </button>
                    </form>

                    <div class="mt-2 text-center">
                        <p class="mr-2">¿Desea subir un manual? <a href="{% url "heim:subir_documentos" %}" class="text-primary">Pulsa Aquí</a></p>
                    </div>

				</div>
			</div>
			<div class="row justify-content-center">
				<div class="col-xl-13">
					<div class="table-wrap">
						<table class="table table-striped">
						  <thead>
						    <tr>
                  <th>Manuales</th>
                  <th>Subcategoría</th>
                  <th>Fecha</th>
                  <th>Aceptado por</th>
                  <th></th>
						    </tr>
						  </thead>
						  <tbody>
                {% for documento in object_list %}
						    <tr>
						      <td scope="row">{{ documento.archivo|archivo }}</td>
                              <td >{{ documento.subcategoria.subcategoria }}</td>
                              <td >{{ documento.fecha_publicacion }}</td>
                              <td >{{ documento.aceptado_por }}</td>
                              <td class="d-flex align-items-center">
                                <a href="{% get_media_prefix %}{{ documento.archivo }}" class="me-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" width="20" height="20" class="me-2">
                                        <!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                                        <path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"/>
                                    </svg>
                                </a>
                                {% if documento.estado != 'Aceptado' %}
                                    <form id="aceptar" method="POST" class="d-inline-block ml-2">
                                        {% csrf_token %}
                                        <input type="hidden" name="id_aceptar" value="{{ documento.id }}" />
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fa-regular fa-circle-check"></i>
                                        </button>
                                    </form>
                                    <form id="rechazar" method="POST" class="d-inline-block ml-1">
                                        {% csrf_token %}
                                        <input type="hidden" name="id_rechazar" value="{{ documento.id }}" />
                                        <button type="submit" class="btn btn-danger">
                                            <i class="fa-regular fa-circle-xmark"></i>
                                        </button>
                                    </form>
                                {% else %}
                                    <form id="rechazar" method="POST" class="d-inline-block ml-2">
                                        {% csrf_token %}
                                        <input type="hidden" name="id_rechazar" value="{{ documento.id }}" />
                                        <button type="submit" class="btn btn-danger">
                                            <i class="fa-regular fa-circle-xmark"></i>
                                        </button>
                                    </form>
                                {% endif %}
                            </td>                            
                            </tr>
                            {% endfor %}
						  </tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</section>
{% endblock contenido %}


  {% comment %} <script src="{% static "js/jquery.min.js" %}"></script>
  <script src="{% static "js/popper.js" %}"></script>
  <script src="{% static "js/bootstrap.min.js" %}"></script>
  <script src="{% static "js/main.js" %}"></script> {% endcomment %}


